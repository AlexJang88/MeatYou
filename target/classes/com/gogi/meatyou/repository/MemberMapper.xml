<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper
  PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN"
  "https://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="com.gogi.meatyou.repository.MemberMapper">


	<select id="memberList" resultType="com.gogi.meatyou.bean.MemberDTO">
		select * from member
	</select>


	<resultMap id="memberMap" type="com.gogi.meatyou.bean.MemberDTO" >
		<result property="m_id" column="m_id" />
		<result property="passwd" column="passwd" />
		<result property="m_name" column="m_name" />
		<result property="birth" column="birth" />
		<result property="m_addr1" column="m_addr1" />
		<result property="m_addr2" column="m_addr2" />
		<result property="email" column="email" />
		<result property="telep" column="telep" />
		<result property="phone" column="phone" />
		<result property="m_reg_date" column="m_reg_date" />
		<result property="m_status" column="m_status" />
		
		<collection property="mstatus_list" resultMap="status" />  
	</resultMap>

	<resultMap id="status" type="com.gogi.meatyou.bean.MemStatusDTO" >
		<result property="msta_m_status" column="msta_m_status" />
		<result property="mstat_detail" column="mstat_detail" />
		<result property="mstat_auth" column="mstat_auth" />
	</resultMap>
	
	

	<select id="read" resultMap="memberMap" resultType="com.gogi.meatyou.bean.MemberDTO" >		
			select * from member a left outer join memstatus b
						on a.m_status = b.msta_m_status
						where a.m_id=#{m_id}
	</select>
	
	
	
	
	
	<select id="member" resultType="com.gogi.meatyou.bean.MemberDTO">
		select * from member where  m_id=#{m_id}
	</select>



 
<!-- 
		<insert id="insertMember" parameterType="com.gogi.meatyou.bean.MemberDTO">
    <![CDATA[
    INSERT INTO member(m_id, passwd, m_name, birth, m_addr1, m_addr2, email, telep, phone, m_status)
    VALUES (
        #{m_id},
        #{passwd},
        #{m_name},
        to_date(#{birth}, 'YYYY-MM-DD'),
        #{m_addr1},
        #{m_addr2},
        #{email},
        #{telep},
        #{phone},
       1001)
    ]]>
</insert>
 -->
			<insert id="insertMember" parameterType="com.gogi.meatyou.bean.MemberDTO">
    <![CDATA[
    INSERT INTO member(m_id, passwd, m_name, birth, m_addr1, m_addr2, email, telep, phone, m_reg_date, m_status)
    VALUES (
        #{m_id},
        #{passwd},
        #{m_name},
        to_date(#{birth}, 'YYYY-MM-DD'),
        #{m_addr1},
        #{m_addr2},
        #{email},
        #{telep},
        #{phone},
        TO_CHAR(SYSDATE, 'YYYY-MM-DD'), 
       1001)
    ]]>
</insert>
		
		
		<update id="memberUpdate" parameterType="com.gogi.meatyou.bean.MemberDTO">
		update member 
			<set>
				<if test="passwd != null and passwd != '' ">passwd=#{passwd},</if>
				<if test="m_name != null and m_name != '' ">m_name=#{m_name},</if>
		<!-- 		<if test="birth != null and birth != '' "> birth = TO_DATE(#{birth}, 'YYYY-MM-DD HH24:MI:SS.FF'),,</if> -->
				<if test="m_addr1 != null and m_addr1 != '' ">m_addr1=#{m_addr1},</if>
				<if test="m_addr2 != null and m_addr2 != '' ">m_addr2=#{m_addr2},</if>
				<if test="email != null and email != '' ">email=#{email},</if>
				<if test="telep != null and telep != '' ">telep=#{telep},</if>
				<if test="phone != null and phone != '' ">phone=#{phone}</if>
			</set> 
		where m_id=#{m_id}
	</update>
	<!-- 
	
		<update id="statusChange" parameterType="com.gogi.meatyou.bean.MemberDTO" >
		update member set m_status = 1001 where m_id=#{m_id} and passwd = #{passwd}		
	</update>
	
	
	 -->
	
	<update id="statusChange" parameterType="com.gogi.meatyou.bean.MemberDTO" >
		update member set m_status = 1000 where  passwd = #{passwd}		
	</update>
	

	
	<update id="statusAdminChange" parameterType="com.gogi.meatyou.bean.MemberDTO">
		update member set m_status=#{m_status} where m_id=#{m_id}
	</update>
	          
		
		
		
		
		
		
		
		
		
		
</mapper>